{"componentChunkName":"component---src-templates-blog-post-js","path":"/animated-numbers-gsap/","result":{"data":{"site":{"siteMetadata":{"title":"rafhun"}},"markdownRemark":{"id":"cebca23a-8709-5f9f-b841-18bec1fd270d","excerpt":"This effect can bring a little bit of life into a display of key numbers say in an annual report or similar. We animate counting from one number to another one…","html":"<p>This effect can bring a little bit of life into a display of key numbers say in an annual report or similar. We animate counting from one number to another one. This effect is further enhanced by only starting once the whole number is in the viewport for the user, thus making sure that the effect can be seen, no matter where on the page it is positioned.</p>\n<h2>Basic markup</h2>\n<p>Make sure that the animated number is the only content of some element. This is because the animated value will be injected into the DOM using Javascript’s <code class=\"language-text\">element.innerHTML</code>. We also use some data attributes that can be set up using a CMS to make customization of the animation easily accessible from a backend.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span>\n  <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>counter<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">data-counter-start</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">data-counter-end</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>238<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">data-counter-duration</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2<span class=\"token punctuation\">\"</span></span>\n<span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>counter-number<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>0<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>counter-legend<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Views<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span>\n  <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>counter<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">data-counter-start</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>10<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">data-counter-end</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">data-counter-duration</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>10<span class=\"token punctuation\">\"</span></span>\n<span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>counter-number<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>10<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>counter-legend<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Seconds to go<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Feel free to style this component to your liking or follow the example given below.</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.counter</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> flex<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">flex-direction</span><span class=\"token punctuation\">:</span> column<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">align-items</span><span class=\"token punctuation\">:</span> center<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.counter-number</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 3em<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">font-weight</span><span class=\"token punctuation\">:</span> bold<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>Animating with Greensock</h2>\n<p>Make sure you have the Greensock (gsap) library available.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save gsap</code></pre></div>\n<p>Import gsap and its ScrollTrigger plugin, register it and set up some sensible defaults.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> gsap <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"gsap\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ScrollTrigger <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"gsap/ScrollTrigger\"</span>\n\ngsap<span class=\"token punctuation\">.</span><span class=\"token function\">registerPlugin</span><span class=\"token punctuation\">(</span>ScrollTrigger<span class=\"token punctuation\">)</span>\nScrollTrigger<span class=\"token punctuation\">.</span><span class=\"token function\">defaults</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  toggleActions<span class=\"token operator\">:</span> <span class=\"token string\">\"restart none none none\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>The <code class=\"language-text\">toggleActions</code> define what happens in each possible case that can occur when scrolling. They are best explained as follows: <code class=\"language-text\">toggleActions: &quot;onEnter, onLeaveDown, onReenter, onLeaveUp&quot;</code>. In this case we restart the count whenever it comes into view while the user is scrolling down. We always run the whole animation and only restart if the user scrolls up and then down again.</p>\n<p>We allow for multiple counters per page as is also shown in the example. Get all of them into an array so you can loop over them with <code class=\"language-text\">forEach</code> using a handy GSAP utility.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">gsap<span class=\"token punctuation\">.</span>utils<span class=\"token punctuation\">.</span><span class=\"token function\">toArray</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".counter\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">counter</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>For each counter we will now read in the data attributes containing the necessary animation information. We also define the element that contains the actual number and declare a counting variable where the actual counting will happen. This variable is necessary because its value will be injected into the DOM on every animation update.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">gsap<span class=\"token punctuation\">.</span>utils<span class=\"token punctuation\">.</span><span class=\"token function\">toArray</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".counter\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">counter</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> startValue <span class=\"token operator\">=</span> counter<span class=\"token punctuation\">.</span><span class=\"token function\">getAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"data-counter-start\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> endValue <span class=\"token operator\">=</span> counter<span class=\"token punctuation\">.</span><span class=\"token function\">getAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"data-counter-end\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> duration <span class=\"token operator\">=</span> counter<span class=\"token punctuation\">.</span><span class=\"token function\">getAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"data-counter-duration\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> counterElement <span class=\"token operator\">=</span> counter<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".count-number\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> counting <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> val<span class=\"token operator\">:</span> startNumber <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// We animate the counting variable</span>\n  gsap<span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span>counting<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Trigger the animation once the top of the counter element has passed the bottom of the viewport by 50px</span>\n    scrollTrigger<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      trigger<span class=\"token operator\">:</span> counter<span class=\"token punctuation\">,</span>\n      start<span class=\"token operator\">:</span> <span class=\"token string\">\"top bottom-=50px\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Set the value to which we are animating -> references the val key in the counting variable</span>\n    val<span class=\"token operator\">:</span> endValue<span class=\"token punctuation\">,</span>\n    duration<span class=\"token operator\">:</span> duration<span class=\"token punctuation\">,</span>\n    <span class=\"token function\">onUpdate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// This callback runs on every animation update. Use this to format the number to your wishes, then inject it into the DOM.</span>\n      <span class=\"token keyword\">const</span> number <span class=\"token operator\">=</span> gsap<span class=\"token punctuation\">.</span>utils<span class=\"token punctuation\">.</span><span class=\"token function\">snap</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> counting<span class=\"token punctuation\">.</span>val<span class=\"token punctuation\">)</span>\n      countElement<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> number<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Most of what is happening here is explained inline using comments. We set up the scroll trigger which defines when to start the animation. Since we are animation an object (<code class=\"language-text\">counting</code>), we reference the object property that is to be animated and set up the targeted end value.</p>\n<p>To format the number <code class=\"language-text\">onUpdate</code> here we are using another gsap utility function that removes all possible digits from the number.</p>","frontmatter":{"title":"Animate a number with Greensock","date":"October 24, 2020","description":null}},"previous":{"fields":{"slug":"/gutenberg-script-versions-in-5-5-1/"},"frontmatter":{"title":"Gutenberg Script Versions in v5.5.1"}},"next":{"fields":{"slug":"/wordpress-custom-block-plugin/"},"frontmatter":{"title":"Custom WordPress Editor Blocks"}}},"pageContext":{"id":"cebca23a-8709-5f9f-b841-18bec1fd270d","previousPostId":"b13c45a4-27fa-5c3e-b3dc-5a76c24e2bc4","nextPostId":"99673c62-dd83-5b4e-8ff0-35e969f3dc70"}},"staticQueryHashes":["2460539594","2841359383"]}